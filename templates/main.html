{% extends "base.html" %}

{%- block site_meta %}
  {{ super() }}
        {% if page %}<meta name="article_title" content="{{ page.title }}">{% endif %}
{% endblock %}

{% block analytics %}
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag() { dataLayer.push(arguments); }
  gtag('consent', 'default', {
    'ad_storage': 'denied',
    'ad_user_data': 'denied',
    'ad_personalization': 'denied',
    'analytics_storage': 'denied'
  });
</script>
<!-- Consent -->
<script>
  window.CookieBannerConfig = {
      onAnalyticsConsent: function (consent) {          
          gtag('consent', 'update', {
            'analytics_storage': consent.analytics ? 'granted' : 'denied',
            'ad_storage': consent.marketing ? 'granted' : 'denied'
        });
      }
    };
    (function checkConsent() {
      const consent = localStorage.getItem('cookieConsent');
      let consentData = null;
      if (consent) {
        try {
          consentData = JSON.parse(consent);          
          window.CookieBannerConfig.onAnalyticsConsent(consentData);
        } catch (e) {        
          consentData = null;
          localStorage.removeItem('cookieConsent');
          console.error('Failed to parse cookie consent from localStorage:', e);
        }
      }
      if (!consentData) {
        const script = document.createElement('script');
        script.src = '/javascripts/c.js';
        script.async = true;
        document.head.appendChild(script);
      }
    })();
</script><!-- End Consent -->
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
 new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
 j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
 'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
 })(window,document,'script','dataLayer','GTM-TCKL8M2M');</script>                                                                                                    
 <!-- End Google Tag Manager -->

{% endblock %}

{% block footer %}
<hr>
  {%- if config.copyright %}
    <p>{{ config.copyright }}</p>
  {%- endif %}
  <p>
    <a href="s/privacy-policy">Privacy Policy</a> | 
    {% trans mkdocs_link='<a href="https://www.mkdocs.org/">MkDocs</a>' %}Built with {{ mkdocs_link }}.{% endtrans %}</p>

{% endblock %}
